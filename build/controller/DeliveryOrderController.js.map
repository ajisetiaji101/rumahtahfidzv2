{"version":3,"file":"DeliveryOrderController.js","names":["_db","_interopRequireDefault","require","_parseJwt","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","DeliveryOrderController","exports","req","no_packaging","params","respon","knex","raw","result","rows","status","json","data","error","message","no_do","tokendata","parseJwt","in_kd_user","plant","existPlant","resultExistPlant","parseInt","total"],"sources":["../../server/controller/DeliveryOrderController.js"],"sourcesContent":["import knex from \"../config/db.js\";\r\nimport parseJwt from \"../helpers/parseJwt.js\";\r\n\r\nexport default class DeliveryOrderController {\r\n  static getDeliveryOrderDetailBypackaging = async (req, res) => {\r\n    const { no_packaging } = req.params;\r\n\r\n    try {\r\n      const respon = await knex.raw(\r\n        `select vo.no_serial , vo.tanggal_produksi , vo.spln , vo.spesifikasi ,vo.masa_garansi , vo.lead_time , vo.nomor_sert_materologi , vo.no_produksi from mims_master.vw_pabrikan_detail_serial_delivery_orders vo where no_packaging = '${no_packaging}'`\r\n      );\r\n\r\n      const result = respon.rows;\r\n\r\n      return res.status(200).json({ data: result });\r\n    } catch (error) {\r\n      return res.status(400).json({ data: error.message });\r\n    }\r\n  };\r\n\r\n  static getDeliveryOrderDetailByDo = async (req, res) => {\r\n    const { no_do } = req.params;\r\n\r\n    try {\r\n      const respon = await knex.raw(\r\n        `select distinct  vo.no_packaging , vo.no_mat_sap , vo.spesifikasi , vo.kategori from mims_master.vw_pabrikan_detail_serial_delivery_orders vo where vo.no_do_smar = '${no_do}' `\r\n      );\r\n\r\n      const result = respon.rows;\r\n\r\n      return res.status(200).json({ data: result });\r\n    } catch (error) {\r\n      return res.status(400).json({ data: error.message });\r\n    }\r\n  };\r\n\r\n  static getDeliveryOrderDetailByUser = async (req, res) => {\r\n    try {\r\n      const tokendata = await parseJwt(req);\r\n\r\n      const in_kd_user = tokendata.plant;\r\n\r\n      const existPlant = await knex.raw(\r\n        `select count(*) as total from mims_master.master_plant mp  where mp.plant =  '${in_kd_user}';`\r\n      );\r\n\r\n      const resultExistPlant = parseInt(existPlant.rows[0].total);\r\n\r\n      if (resultExistPlant == 0) {\r\n        return res.status(400).json({ data: \"Unit tidak ada\" });\r\n      }\r\n\r\n      const respon = await knex.raw(\r\n        `select distinct vo.id,vo.no_do_smar,vo.po_mp_no,vo.po_sap_no,vo.total, vo.do_status, vo.unit, vo.no_do_mims,vo.kode_status_do_mims, vo.status_do_mims, vo.plant_code_no ,vo.kd_pabrikan from mims_master.vw_pabrikan_monitoring_delivery_orders vo where plant_code_no = '${in_kd_user}' order by vo.id desc `\r\n      );\r\n\r\n      const result = respon.rows;\r\n\r\n      return res.status(200).json({ data: result });\r\n    } catch (error) {\r\n      return res.status(400).json({ data: error.message });\r\n    }\r\n  };\r\n}\r\n"],"mappings":";;;;;;AAAA,IAAAA,GAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AAA8C,SAAAD,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,gBAAAH,GAAA,EAAAI,GAAA,EAAAC,KAAA,IAAAD,GAAA,GAAAE,cAAA,CAAAF,GAAA,OAAAA,GAAA,IAAAJ,GAAA,IAAAO,MAAA,CAAAC,cAAA,CAAAR,GAAA,EAAAI,GAAA,IAAAC,KAAA,EAAAA,KAAA,EAAAI,UAAA,QAAAC,YAAA,QAAAC,QAAA,oBAAAX,GAAA,CAAAI,GAAA,IAAAC,KAAA,WAAAL,GAAA;AAAA,SAAAM,eAAAM,GAAA,QAAAR,GAAA,GAAAS,YAAA,CAAAD,GAAA,2BAAAR,GAAA,gBAAAA,GAAA,GAAAU,MAAA,CAAAV,GAAA;AAAA,SAAAS,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AAE/B,MAAMU,uBAAuB,CAAC;AA4D5CC,OAAA,CAAAxB,OAAA,GAAAuB,uBAAA;AAAAtB,eAAA,CA5DoBsB,uBAAuB,uCACC,OAAOE,GAAG,EAAEN,GAAG,KAAK;EAC7D,MAAM;IAAEO;EAAa,CAAC,GAAGD,GAAG,CAACE,MAAM;EAEnC,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMC,WAAI,CAACC,GAAG,CAC1B,wOAAuOJ,YAAa,GAAE,CACxP;IAED,MAAMK,MAAM,GAAGH,MAAM,CAACI,IAAI;IAE1B,OAAOb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEJ;IAAO,CAAC,CAAC;EAC/C,CAAC,CAAC,OAAOK,KAAK,EAAE;IACd,OAAOjB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEC,KAAK,CAACC;IAAQ,CAAC,CAAC;EACtD;AACF,CAAC;AAAApC,eAAA,CAfkBsB,uBAAuB,gCAiBN,OAAOE,GAAG,EAAEN,GAAG,KAAK;EACtD,MAAM;IAAEmB;EAAM,CAAC,GAAGb,GAAG,CAACE,MAAM;EAE5B,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMC,WAAI,CAACC,GAAG,CAC1B,wKAAuKQ,KAAM,IAAG,CAClL;IAED,MAAMP,MAAM,GAAGH,MAAM,CAACI,IAAI;IAE1B,OAAOb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEJ;IAAO,CAAC,CAAC;EAC/C,CAAC,CAAC,OAAOK,KAAK,EAAE;IACd,OAAOjB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEC,KAAK,CAACC;IAAQ,CAAC,CAAC;EACtD;AACF,CAAC;AAAApC,eAAA,CA/BkBsB,uBAAuB,kCAiCJ,OAAOE,GAAG,EAAEN,GAAG,KAAK;EACxD,IAAI;IACF,MAAMoB,SAAS,GAAG,MAAM,IAAAC,iBAAQ,EAACf,GAAG,CAAC;IAErC,MAAMgB,UAAU,GAAGF,SAAS,CAACG,KAAK;IAElC,MAAMC,UAAU,GAAG,MAAMd,WAAI,CAACC,GAAG,CAC9B,iFAAgFW,UAAW,IAAG,CAChG;IAED,MAAMG,gBAAgB,GAAGC,QAAQ,CAACF,UAAU,CAACX,IAAI,CAAC,CAAC,CAAC,CAACc,KAAK,CAAC;IAE3D,IAAIF,gBAAgB,IAAI,CAAC,EAAE;MACzB,OAAOzB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE;MAAiB,CAAC,CAAC;IACzD;IAEA,MAAMP,MAAM,GAAG,MAAMC,WAAI,CAACC,GAAG,CAC1B,6QAA4QW,UAAW,wBAAuB,CAChT;IAED,MAAMV,MAAM,GAAGH,MAAM,CAACI,IAAI;IAE1B,OAAOb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEJ;IAAO,CAAC,CAAC;EAC/C,CAAC,CAAC,OAAOK,KAAK,EAAE;IACd,OAAOjB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAEC,KAAK,CAACC;IAAQ,CAAC,CAAC;EACtD;AACF,CAAC"}